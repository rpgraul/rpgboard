import*as cardRenderer from"./cardRenderer.js";import{showConfirmationPopover}from"./ui.js";let localItems=[],eventHandlers={};const itemsContainer=document.getElementById("grid-view-container"),searchInput=document.getElementById("search-input"),loadingIndicator=document.getElementById("loading-indicator");export function initializeGrid(e){eventHandlers=e,itemsContainer.addEventListener("click",(e=>{const n=e.target,t=n.closest(".action-icon"),i=n.closest(".card");if(!t||!i)return;const a=i.dataset.id,s=localItems.find((e=>e.id===a));s&&(t.classList.contains("view-btn")?eventHandlers.onView(s):t.classList.contains("delete-btn")?showConfirmationPopover({targetElement:t,message:"Deletar este card?",onConfirm:()=>eventHandlers.onDelete(s)}):t.classList.contains("edit-btn")?eventHandlers.onEdit(i,s,itemsContainer):t.classList.contains("save-btn")?eventHandlers.onSave(i,s,itemsContainer):t.classList.contains("cancel-btn")&&(itemsContainer.classList.remove("is-editing-item"),cardRenderer.renderCardViewMode(i,s),i._newImageFile&&delete i._newImageFile,muuriGrid?.layout(!0)))}))}export function updateItems(e){localItems=e,loadingIndicator&&(loadingIndicator.style.display="none"),renderAllItems(e)}export function updateFileName(e){const n=e.closest(".file.has-name")?.querySelector(".file-name");n&&(e.files.length>0?n.textContent=e.files[0].name:n.textContent="Nenhuma imagem selecionada")}function renderAllItems(e){if(itemsContainer.innerHTML="",0===e.length&&searchInput.value)itemsContainer.innerHTML=`<div class="column is-full has-text-centered"><p class="is-size-5 has-text-grey">Nenhum item encontrado para "${searchInput.value}".</p></div>`;else{const n=e.map(cardRenderer.createCardElement);itemsContainer.append(...n)}}