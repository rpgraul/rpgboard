import*as cardRenderer from"./cardRenderer.js";import{showConfirmationPopover}from"./ui.js";let localItems=[],filteredItems=[],eventHandlers={};const boardContainer=document.getElementById("board-view-container");let boardSearchInput=null;export function initializeBoard(e){eventHandlers=e,boardContainer?(boardSearchInput=document.getElementById("board-search-input"),boardSearchInput&&boardSearchInput.addEventListener("input",filterAndRender),boardContainer.addEventListener("click",(e=>{const t=e.target,n=t.closest(".action-icon"),r=t.closest(".card");if(!n||!r)return;const o=r.dataset.id,a=localItems.find((e=>e.id===o));a&&(n.classList.contains("view-btn")?eventHandlers.onView(a):n.classList.contains("delete-btn")?showConfirmationPopover({targetElement:n,message:"Deletar este card?",onConfirm:()=>eventHandlers.onDelete(a)}):n.classList.contains("edit-btn")?eventHandlers.onEdit(r,a,boardContainer):n.classList.contains("save-btn")?eventHandlers.onSave(r,a,boardContainer):n.classList.contains("cancel-btn")&&(boardContainer.classList.remove("is-editing-item"),cardRenderer.renderCardViewMode(r,a),r._newImageFile&&delete r._newImageFile))}))):console.error("Board container not found!")}export function renderBoardItems(e){localItems=e,filterAndRender()}function filterAndRender(){const e=boardSearchInput?boardSearchInput.value.toLowerCase().trim():"";filteredItems=e?localItems.filter((t=>{const n=t.titulo.toLowerCase().includes(e),r="texto"===t.tipo&&t.conteudo.toLowerCase().includes(e),o="imagem"===t.tipo&&t.descricao?.toLowerCase().includes(e),a=t.tags.some((t=>t.toLowerCase().includes(e)));return n||r||o||a})):[...localItems],drawBoard()}function drawBoard(){if(boardContainer.querySelectorAll(".card").forEach((e=>e.remove())),filteredItems.length>0){const e=filteredItems.map(((e,t)=>{const n=cardRenderer.createCardElement(e),r=80+30*t,o=40+30*t;return n.style.top=`${r}px`,n.style.left=`${o}px`,n}));boardContainer.append(...e)}}