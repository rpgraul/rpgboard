import{openModal,closeModal}from"./modal.js";const NARRATOR_PASSWORDS=["dimitrinho","tomatinho"],STORAGE_KEY="isNarrator",USER_NAME_KEY="rpgboard_user_name";let narratorModal=null,loginBtn=null,loginForm=null,passwordInput=null,errorMessage=null;export function isNarrator(){return"true"===localStorage.getItem(STORAGE_KEY)}export function getCurrentUserName(){return localStorage.getItem(USER_NAME_KEY)||"Visitante"}function login(){localStorage.setItem(STORAGE_KEY,"true"),closeModal(narratorModal),window.dispatchEvent(new Event("narratorStatusChange"))}function logout(){localStorage.removeItem(STORAGE_KEY),window.dispatchEvent(new Event("narratorStatusChange"))}function handleLoginAttempt(event){event.preventDefault();const pwd=passwordInput&&passwordInput.value?passwordInput.value.trim():"";pwd&&NARRATOR_PASSWORDS.some((p=>p===pwd))?(errorMessage&&errorMessage.classList.add("is-hidden"),login()):(errorMessage&&errorMessage.classList.remove("is-hidden"),passwordInput&&(passwordInput.value=""))}export function initializeAuth(){narratorModal=document.getElementById("narrator-modal"),loginBtn=document.getElementById("narrator-login-btn"),loginForm=document.getElementById("form-narrator-login"),passwordInput=document.getElementById("narrator-password"),errorMessage=document.getElementById("narrator-error-message"),narratorModal&&loginBtn&&loginForm&&(loginBtn.addEventListener("click",(()=>{isNarrator()?logout():openModal(narratorModal)})),loginForm.addEventListener("submit",handleLoginAttempt))}