import{Node,mergeAttributes}from"@tiptap/core";export default Node.create({name:"containerShortcode",group:"block",content:"block+",defining:!0,draggable:!0,selectable:!0,addAttributes:()=>({label:{default:"Novo Container"},type:{default:"default"},isHidden:{default:!1},isOpen:{default:!0}}),parseHTML:()=>[{tag:'div[data-node-type="containerShortcode"]',getAttrs:dom=>({label:dom.getAttribute("data-label"),type:dom.getAttribute("data-type"),isHidden:"true"===dom.getAttribute("data-is-hidden")})}],renderHTML:({HTMLAttributes:HTMLAttributes})=>["div",mergeAttributes(HTMLAttributes,{"data-node-type":"containerShortcode"}),0],addNodeView(){return({node:node,getPos:getPos,editor:editor})=>{const dom=document.createElement("div");dom.className=`shortcode-container-editor type-${node.attrs.type}`,dom.classList.toggle("is-hidden-preview",node.attrs.isHidden),dom.classList.toggle("is-collapsed",!node.attrs.isOpen),dom.setAttribute("data-label",node.attrs.label);const header=document.createElement("div");header.className="container-header",header.contentEditable="false";const iconSpan=document.createElement("span");iconSpan.className="icon is-small";var type;iconSpan.innerHTML=`<i class="fas ${type=node.attrs.type,"inventory"===type?"fa-suitcase":"spells"===type?"fa-scroll":"skills"===type?"fa-fist-raised":"fa-box"}"></i>`;const labelSpan=document.createElement("strong");labelSpan.className="container-label",labelSpan.textContent=node.attrs.label;const actions=document.createElement("div");actions.className="container-actions";const visibilityBtn=document.createElement("button");visibilityBtn.className="button is-small is-ghost "+(node.attrs.isHidden?"has-text-danger":"has-text-success"),visibilityBtn.innerHTML=`<i class="fas ${node.attrs.isHidden?"fa-eye-slash":"fa-eye"}"></i>`,visibilityBtn.onclick=()=>{"function"==typeof getPos&&editor.commands.updateAttributes("containerShortcode",{isHidden:!node.attrs.isHidden})};const toggleBtn=document.createElement("button");toggleBtn.className="button is-small is-ghost",toggleBtn.innerHTML=`<i class="fas ${node.attrs.isOpen?"fa-chevron-down":"fa-chevron-right"}"></i>`,toggleBtn.onclick=()=>{"function"==typeof getPos&&editor.commands.updateAttributes("containerShortcode",{isOpen:!node.attrs.isOpen})},actions.append(visibilityBtn,toggleBtn),header.append(iconSpan,labelSpan,actions);const contentDOM=document.createElement("div");return contentDOM.className="container-content-area",dom.append(header,contentDOM),header.ondblclick=e=>{e.preventDefault(),e.stopPropagation(),document.dispatchEvent(new CustomEvent("edit-shortcode",{detail:{type:"container",attrs:node.attrs,pos:getPos()}}))},{dom:dom,contentDOM:contentDOM,stopEvent:event=>!!event.target.closest("button"),ignoreMutation:mutation=>"childList"===mutation.type&&("SVG"===mutation.target.nodeName||"path"===mutation.target.nodeName),update:updatedNode=>updatedNode.type.name===this.name}}}});