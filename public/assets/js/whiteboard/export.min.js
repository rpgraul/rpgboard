import{canvas}from"./canvas.js";export function initializeExport(){document.getElementById("btn-export").addEventListener("click",(()=>{canvas.discardActiveObject(),canvas.renderAll();const objs=canvas.getObjects();if(!objs.length)return alert("Board vazio.");let minX=1/0,minY=1/0,maxX=-1/0,maxY=-1/0;objs.forEach((o=>{const b=o.getBoundingRect();b.left<minX&&(minX=b.left),b.top<minY&&(minY=b.top),b.left+b.width>maxX&&(maxX=b.left+b.width),b.top+b.height>maxY&&(maxY=b.top+b.height)}));const dataURL=canvas.toDataURL({format:"jpeg",quality:.9,left:Math.max(0,minX-50),top:Math.max(0,minY-50),width:maxX-minX+100,height:maxY-minY+100,enableRetinaScaling:!0}),link=document.createElement("a");link.download=`whiteboard-export-${Date.now()}.jpg`,link.href=dataURL,document.body.appendChild(link),link.click(),document.body.removeChild(link)}))}